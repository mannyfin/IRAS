function []=langmuir()

%==========================================================================
screen=get(0,'screensize');
screen=screen(3:4);

handle.figure=figure(...
    'Name', 'Langmuir',...
    'NumberTitle', 'off',...
    'color',[.94,.94,.94],...
    'position',[0*screen(1),0.04*screen(2),screen(1),0.87*screen(2)]);
%Axes
handle.axes=axes(...
    'units','normalized',...
    'position',[0.36,0.14,0.38,0.8]);
%Panels
handle.parameters=uipanel(...
    'Title', 'Parameters',...
    'backgroundcolor',[.94,.94,.94],...
    'position', [0.76,0.21,0.23,0.75]);
handle.constantT=uipanel(...
    'Title', 'Constant Epsilon',...
    'parent',handle.parameters,...
    'backgroundcolor',[.94,.94,.94],...
    'position', [0.05,0.46,0.9,0.41]);
handle.constanteps=uipanel(...
    'Title', 'Constant Temperature',...
    'parent',handle.parameters,...
    'backgroundcolor',[.94,.94,.94],...
    'position', [0.05,0.03,0.9,0.41]);

handle.axeslength=uipanel(...
    'Title', 'X Axis',...
    'backgroundcolor',[.94,.94,.94],...
    'position', [0.378,0.01,0.35,0.09]);
columnname={'Pressure (Pa)','Theta[1]', 'Theta[2]', 'Theta[3]','Theta[4]'};
columnformat={'numeric','numeric','numeric','numeric','numeric'};
handle.table=uitable(...
    'units','normalized',...
    'position', [0.039 0.01 0.25 0.2],...
    'ColumnName', columnname,...
    'ColumnFormat', columnformat,...
    'RowName', []);

%strings with equations
textbox
    function []=textbox()
        handle.newtextbox=axes(...
            'units','normalized',...
            'position',[0.0125,0.26,0.3,0.68],...
            'xtick',[], 'ytick', [],...
            'xcolor', 'w', 'ycolor','w');
        
        str(1)={'===Langmuir Adsorption Isotherms==='};
        str(2)={'The equilibrium coverage of a gas'};
        str(3)={' adsorbing onto a surface can be'};
        str(4)={'described by the Langmuir Isotherm,'};
        str(5)={''};
        str(6)={'$$\theta=\frac{p}{p+p_0(T)}$$'};
        str(7)={''};
        str(8)={'where $$p_0(T)$$ is given by:'};
        str(9)={''};
        str(10)={'$$p_0(T)=(\frac{2\pi m k_B T}{h^2})^{3/2}k_B T exp(\frac{-\epsilon}{k_B T})$$'};
        str(11)={''};
        str(12)={'under the assumptions that the gas is'};
        str(13)={'monoatomic and ideal, there are $$\sigma_o$$ equivalent'};
        str(14)={'sites, and only one adsorbate binds'};
        str(15)={'to each site.'};
        str(16)={''};
        str(17)={'m=mass of adsorbate atom [kg]'};
        str(18)={'$$k_B$$= Boltzmann constant [J/K]'};
        str(19)={'h=Planck constant[J*s]'};
        str(20)={'$$\epsilon $$= binding energy[kJ/mol]'};
        str(21)={'T=temperature [K]'};
        str(22)={'P=equilibrium pressure of the gas [Pa]'};
        
        
        set(handle.figure,'currentaxes',handle.newtextbox);
        ltxstr=text('interpreter','latex','string',str, 'units','normalized','position',[.05 .5],'fontsize',16);
    end

%--------------------------------------------------------------------------
%Edit box for constant mass
%Constant Mass
handle.mass=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '28',...
    'position', [.35 .93 .3 .07],...
    'parent', handle.parameters,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.parameters,...
    'units', 'normalized',...
    'string', 'Mass of adsorbed molecule [g/mol]',...
    'position', [0.15,0.88,0.7,0.05]);

%Edit boxes for ConstantT

%Temp1
handle.temp1=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '300',...
    'position', [.1 .78 .3 .17],...
    'parent', handle.constantT,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constantT,...
    'units', 'normalized',...
    'string', 'Temp 1 [K]',...
    'position', [0.1,0.68,0.3,0.1]);

%Temp2
handle.temp2=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '350',...
    'position', [.6 .78 .3 .17],...
    'parent', handle.constantT,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constantT,...
    'units', 'normalized',...
    'string', 'Temp 2 [K]',...
    'position', [0.6,0.68,0.3,0.1]);

% Temp3
handle.temp3=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '375',...
    'position', [.1 .45 .3 .17],...
    'parent', handle.constantT,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constantT,...
    'units', 'normalized',...
    'string', 'Temp 3 [K]',...
    'position', [0.1,0.35,0.3,0.1]);

%Temp4
handle.temp4=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '400',...
    'position', [.6 .45 .3 .17],...
    'parent', handle.constantT,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constantT,...
    'units', 'normalized',...
    'string', 'Temp 4 [K]',...
    'position', [0.6,0.35,0.3,0.1]);

%Constant Epss
handle.constantepss=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '100',...
    'position', [.1 .13 .3 .17],...
    'parent', handle.constantT,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constantT,...
    'units', 'normalized',...
    'string', 'Constant Epsilon [kJ/mol]',...
    'position', [0,0.03,0.5,0.1]);


%--------------------------------------------------------------------------
%Editboxes for constant eps
%eps1
handle.eps1=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '100',...
    'position', [.1 .78 .3 .17],...
    'parent', handle.constanteps,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constanteps,...
    'units', 'normalized',...
    'string', 'Epsilon 1[kJ/mol]',...
    'position', [0.1,0.68,0.3,0.1]);

%eps2
handle.eps2=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '90',...
    'position', [.6 .78 .3 .17],...
    'parent', handle.constanteps,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constanteps,...
    'units', 'normalized',...
    'string', 'Epsilon 2 [kJ/mol]',...
    'position', [0.6,0.68,0.3,0.1]);

% eps3
handle.eps3=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '80',...
    'position', [.1 .45 .3 .17],...
    'parent', handle.constanteps,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constanteps,...
    'units', 'normalized',...
    'string', 'Epsilon 3 [kJ/mol]',...
    'position', [0.1,0.35,0.3,0.1]);

%Temp4
handle.eps4=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '70',...
    'position', [.6 .45 .3 .17],...
    'parent', handle.constanteps,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constanteps,...
    'units', 'normalized',...
    'string', 'Epsilon 4 [kJ/mol]',...
    'position', [0.6,0.35,0.3,0.1]);

%Constant eps
handle.constantTT=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '300',...
    'position', [.1 .13 .3 .17],...
    'parent', handle.constanteps,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.constanteps,...
    'units', 'normalized',...
    'string', 'Constant Temp [K]',...
    'position', [0,0.03,0.5,0.1]);




%Pmin
handle.pmin=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '1E-8',...
    'position', [.05 .4 .4 .45],...
    'parent', handle.axeslength,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.axeslength,...
    'units', 'normalized',...
    'string', 'Pmin',...
    'position', [.05 .1 .4 .2]);

%Pmax
handle.pmax=uicontrol(...
    'style','edit',...
    'units', 'normalized',...
    'string', '1E-2',...
    'position', [.55 .4 .4 .45],...
    'parent', handle.axeslength,...
    'backgroundcolor', 'w');
uicontrol(...
    'style', 'text',...
    'parent', handle.axeslength,...
    'units', 'normalized',...
    'string', 'Pmax',...
    'position', [.55 .15 .4 .2]);


%=========================================================================


%create plot button
handle.plotconstanteps=uicontrol(...
    'style','pushbutton',...
    'units','normalized',...
    'parent',handle.constantT,...
    'position',[.6 .13 .3 .17],...
    'string','Plot');

handle.plotconstantTT=uicontrol(...
    'style','pushbutton',...
    'units','normalized',...
    'parent',handle.constanteps,...
    'position',[.6 .13 .3 .17],...
    'string','Plot');


%==========================================================================
%Associate callbacks

set(handle.plotconstanteps,'callback',{@plotmyploteps})
set(handle.plotconstantTT,'callback',{@plotmyplotTT})
set(handle.pmin,'callback',{@axis})
set(handle.pmax,'callback',{@axis})


%==========================================================================

    function [T1,T2,T3,T4,constTT,eps1,eps2,eps3,eps4,consteps,pmin,pmax, mass]=getstuff(varargin)
        mass = str2double(get(handle.mass,'string'));
        pmin = str2double(get(handle.pmin,'string'));
        pmax = str2double(get(handle.pmax,'string'));
        T1 = str2double(get(handle.temp1,'string'));
        T2 = str2double(get(handle.temp2,'string'));
        T3 = str2double(get(handle.temp3,'string'));
        T4 = str2double(get(handle.temp4,'string'));
        constTT = str2double(get(handle.constantTT,'string'));
        eps1= str2double(get(handle.eps1,'string'));
        eps2 = str2double(get(handle.eps2,'string'));
        eps3 = str2double(get(handle.eps3,'string'));
        eps4 = str2double(get(handle.eps4,'string'));
        consteps = str2double(get(handle.constantepss,'string'));
    end

    function axis(varargin)
        set(handle.figure,'currentaxes',handle.axes)
        [T1,T2,T3,T4,constTT,eps1,eps2,eps3,eps4,consteps,pmin,pmax, mass]=getstuff(varargin);
        pp=1;
        xlim([pmin,pmax]);
        legend('location','best');
    end

    function plotmyplotTT(varargin)
        cla
        set(handle.figure,'currentaxes',handle.axes)
        [T1,T2,T3,T4,constTT,eps1,eps2,eps3,eps4,consteps, mass]=getstuff();
        h=6.626E-34;
        kB = 1.38E-23;
        Na = 6.022E23;
        m=mass*1E-3/Na;
        T=constTT;
        eps=[eps1,eps2,eps3,eps4];
        po=(2*pi*m*kB*T/h^2)^(3/2)*kB*T*exp(-(1E3*eps./Na)/(kB*T));
        p=logspace(-20,0,5000);
        h=waitbar(0,'Please wait...');
        for i=1:length(eps);
            theta(i,:)=p./(p+po(i));
            waitbar(i/length(eps))
            vari=num2str(eps(1,i));
            KK(i,1:length(vari))=vari;
        end
        close(h)
        semilogx(p,theta);
        dataa=vertcat(p,theta);
        xlabel('Pressure [Pa]')
        ylabel('Coverage, theta')
        title('Langmuir Adsorption Isotherm (Constant Temperature)')
        legend('show')
        legend(KK)
        legend('location','best')
        set(handle.table,'data',dataa')
        axis
        textbox
        
    end
    function plotmyploteps(varargin)
        cla
        set(handle.figure,'currentaxes',handle.axes)
        [T1,T2,T3,T4,constTT,eps1,eps2,eps3,eps4,consteps,pmin,pmax, mass]=getstuff();
        h=6.626E-34;
        kB=1.38E-23;
        Na = 6.022E23;
        m=mass*1E-3/Na;
        eps=consteps;
        T=[T1,T2,T3,T4];
        po=(2.*pi.*m.*kB.*T/h^2).^(3/2).*kB.*T.*exp(-(1E3.*eps./Na)./(kB.*T));
        p=logspace(-20,0,5000);
        h=waitbar(0,'Please wait...');
        for i=1:length(T);
            theta(i,:)=p./(p+po(i));
            waitbar(i/length(T))
            vari=num2str(T(1,i));
            KK(i,1:length(vari))=vari;
        end
        close(h)
        semilogx(p,theta);
        pp=1;
        dataa=vertcat(p,theta);
        pp=1;
        xlabel('Pressure [Pa]')
        ylabel('Coverage, theta')
        title('Langmuir Adsorption Isotherm (Constant Epsilon)')
        legend('show')
        legend(KK)
        legend('location','best')
        set(handle.table,'data',dataa')
        axis
        textbox
    end


end